
```c
#include <stdio.h>
#include <Windows.h>

int main()
{
   HMODULE hModule = GetModuleHandle("HelloWorld.dll");
   if(NULL == hModule){
      HMODULE hModule = LoadLibrary("HelloWorld.dll");
      if(NULL == hModule){
         printf("load library failed...\n");
         getchar();
         return 1;
      }
   }
      
   FARPROC fn = GetProcAddress(hModule, "SayHello");
   fn();
   
   FreeLibrary(hModule);
   getchar();

   return 0;
}
```
